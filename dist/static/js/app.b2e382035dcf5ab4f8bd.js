webpackJsonp([1],{"5zbw":function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),n=s("mvHQ"),o=s.n(n),i=s("8l42"),r=s.n(i);r.a.init({appId:"C8YAmtPqP1udTULP5RfRbRcR-gzGzoHsz",appKey:"PcW6DladugIs35VrRljo6im5"});var c={data:function(){return{title:"Welcome,",title2:"ToDoList",isActive:!0,items:[],newTodo:"",checked:!1,actionType:"signUp",formData:{userName:"",password:""},currentUser:""}},created:function(){this.currentUser=this.getCurrentUser(),this.fetchTodos()},methods:{toggleTabClass:function(t){for(var e=0;e<t.target.parentElement.parentElement.children.length;e++)t.target.parentElement.parentElement.children[e].classList.remove("active");t.target.parentElement.classList.add("active")},toggleClass:function(t){t.isFinished=!t.isFinished,this.saveOrUpdateTodos(),console.log(1)},fetchTodos:function(){var t=this;this.currentUser&&new r.a.Query("todos").find().then(function(e){console.log(e);var s=e[0],a=s.id;t.items=JSON.parse(s.attributes.content),t.items.id=a,console.log(t.items)},function(t){console.log(t)})},updateTodos:function(){var t=o()(this.items),e=r.a.Object.createWithoutData("todos",this.items.id);e.set("content",t),e.save().then(function(){console.log("更新成功")})},saveTodos:function(){var t=this,e=o()(this.items),s=new(r.a.Object.extend("todos")),a=new r.a.ACL;a.setReadAccess(r.a.User.current(),!0),a.setWriteAccess(r.a.User.current(),!0),s.set("content",e),s.setACL(a),s.save().then(function(e){t.items.id=e.id,console.log("save：",e)},function(t){console.log("fail")})},saveOrUpdateTodos:function(){this.items.id?this.updateTodos():this.saveTodos()},createNewList:function(){this.items.push({label:this.newTodo,isFinished:!1,createAt:(new Date).toISOString().toString().substr(0,10)+" | "+(new Date).toString().substr(16,8)}),this.newTodo="",this.saveOrUpdateTodos()},removeItem:function(t){var e=this.items.indexOf(t);this.items.splice(e,1),this.saveOrUpdateTodos()},signUp:function(){var t=this,e=new r.a.User;e.setUsername(this.formData.userName),e.setPassword(this.formData.password),e.signUp().then(function(e){t.currentUser=t.getCurrentUser()},function(t){alert("注册失败")})},login:function(){var t=this;r.a.User.logIn(this.formData.userName,this.formData.password).then(function(e){t.currentUser=t.getCurrentUser(),t.fetchTodos()},function(t){console.log(t)})},logout:function(){r.a.User.logOut(),this.currentUser=null,window.location.reload()},getCurrentUser:function(){var t=r.a.User.current();return t?{id:t.id,createAt:t.createAt,username:t.attributes.username}:null}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("h1",[t._v(t._s(t.title)),s("span",[t._v(t._s(t.title2))])]),t._v(" "),t.currentUser?t._e():s("section",{attrs:{id:"logInAndSignUp"}},[s("div",{staticClass:"wrapper"},[s("div",{staticClass:"tab-title"},[s("label",{staticClass:"active"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.actionType,expression:"actionType"}],attrs:{type:"radio",name:"type",value:"signUp"},domProps:{checked:t._q(t.actionType,"signUp")},on:{click:t.toggleTabClass,change:function(e){t.actionType="signUp"}}}),t._v("注册")]),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.actionType,expression:"actionType"}],attrs:{type:"radio",name:"type",value:"login"},domProps:{checked:t._q(t.actionType,"login")},on:{click:t.toggleTabClass,change:function(e){t.actionType="login"}}}),t._v("登录")])]),t._v(" "),"signUp"===t.actionType?s("div",{staticClass:"signUp"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.signUp(e)}}},[s("div",{staticClass:"formRow"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.userName,expression:"formData.userName"}],attrs:{type:"text",placeholder:"用户名"},domProps:{value:t.formData.userName},on:{input:function(e){e.target.composing||t.$set(t.formData,"userName",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"formRow"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.password,expression:"formData.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.formData.password},on:{input:function(e){e.target.composing||t.$set(t.formData,"password",e.target.value)}}})]),t._v(" "),t._m(0)])]):t._e(),t._v(" "),"login"===t.actionType?s("div",{staticClass:"login"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[s("div",{staticClass:"formRow"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.userName,expression:"formData.userName"}],attrs:{type:"text",placeholder:"用户名"},domProps:{value:t.formData.userName},on:{input:function(e){e.target.composing||t.$set(t.formData,"userName",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"formRow"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.password,expression:"formData.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.formData.password},on:{input:function(e){e.target.composing||t.$set(t.formData,"password",e.target.value)}}})]),t._v(" "),t._m(1)])]):t._e()]),t._v(" "),t._m(2)]),t._v(" "),t.currentUser?s("section",{attrs:{id:"todo"}},[s("div",[s("button",{staticClass:"logout",on:{click:t.logout}},[t._v("登出")])]),t._v(" "),s("div",{staticClass:"newTask"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTodo,expression:"newTodo"}],attrs:{type:"text",placeholder:"做你爱做的事吧！"},domProps:{value:t.newTodo},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.createNewList(e):null},input:function(e){e.target.composing||(t.newTodo=e.target.value)}}})]),t._v(" "),s("ul",t._l(t.items,function(e){return s("li",{class:{finished:e.isFinished},on:{click:function(s){t.toggleClass(e)}}},[s("p",{staticClass:"liItem"},[t._v(t._s(e.label))]),t._v(" "),s("div",{attrs:{id:"checkbox"},model:{value:e.isFinished,callback:function(s){t.$set(e,"isFinished",s)},expression:"item.isFinished"}},[t._v("完")]),t._v(" "),(e.isFinished,s("p",{staticClass:"date"},[t._v(t._s(e.createAt))])),t._v(" "),s("button",{on:{click:function(s){t.removeItem(e)}}},[t._v("X")])])})),t._v(" "),t._m(3)]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formActions"},[e("input",{attrs:{type:"submit",value:"注册"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formActions"},[e("input",{attrs:{type:"submit",value:"登录"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"information"},[this._v("Written & Design By "),e("a",{attrs:{href:"https://github.com/bluesbonewong/toDoList_Vue.js",target:"_blank"}},[this._v("bluesboneWong")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"information"},[this._v("Written & Design By "),e("a",{attrs:{href:"https://github.com/bluesbonewong/toDoList_Vue.js",target:"_blank"}},[this._v("bluesboneWong")])])}]};var u=s("VU/8")(c,l,!1,function(t){s("5zbw")},null,null).exports;a.a.config.productionTip=!1,new a.a({el:"#app",components:{App:u},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.b2e382035dcf5ab4f8bd.js.map